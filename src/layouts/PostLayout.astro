---
import MainLayout from "./MainLayout.astro";
import { Image } from "astro:assets";
import dateFormat from "dateformat";
import me from '../../public/images/me-small.jpg'
import UpArrow from "../components/UpArrow.astro";
import readingTime from "reading-time";
import Tag from "../components/Tag.astro";
import TableOfContents from "../components/TableOfContents.astro";
import PostNavigation from "../components/PostNavigation.astro";

let {
    content: {
        title,
        description, 
        tags,
        author,
        pubDate,
        image: {
            url,
            alt
        },
        updatedDate,
    },
    nextPrevious:{
        previousPost,
        nextPost
    },
    body,
    headings
} = Astro.props;
---
<MainLayout title={title}>
    <div class="flex flex-col gap-4 items-center text-center w-1/2 place-self-center">
        <Image layout="responsive" width={750} height={500} inferSize={true} src={url} alt={alt}/>
        <div class="prose prose-light"><h1>{title}</h1></div>  
        <p><em>{description}</em></p>
        <div class="w-full flex flex-col items-center gap-8">
            <div class="flex flex-row items-center">
                <div class="flex flex-row items-center gap-2">
                    <Image class="rounded-full w-8 h-8" src={me} alt="me"/>
                    <p>{author}</p>
                    <p>|</p>
                    <p>{dateFormat(pubDate, "UTC:mmmm dS, yyyy")}</p>
                    <p>|</p>
                    <p>{Math.round(readingTime(body).minutes)} min read</p>
                </div>
            </div>
            {updatedDate && <p><em>Updated {dateFormat(updatedDate, "UTC:mmmm dS, yyyy")}</em></p>}
            <PostNavigation previousPost={previousPost} nextPost={nextPost}/>
        </div>
        <div class="flex flex-row flex-wrap gap-4 w-3/4 justify-center pt-4 pb-4">
            {tags.map((tag: string) => 
                <Tag tag={tag} disabled={"pointer-events-auto"}/>
            )}
        </div>
        <div class="flex flex-row gap-8 w-[150%] place-self-center">
            <aside class="w-1/4 h-full flex flex-col sticky top-8">
                <TableOfContents headings={headings}/>
            </aside>
            <article class="prose prose-light flex flex-col w-1/2 text-start">
                <slot />
            </article>
        </div>
    </div>
</MainLayout>
<button id="scrollTopBtn" class="fixed right-4 bottom-4" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
    <UpArrow class={"fill-white w-16 h-16 border p-4 rounded-3xl hover:bg-slate-500"}/>
</button>